// Copyright (c) 2020 Target Brands, Inc. All rights reserved.
//
// Use of this source code is governed by the LICENSE file in this repository.

// ┌─┐┌─┐┬─┐┌┬┐┌─┐
// ├┤ │ │├┬┘│││└─┐
// └  └─┘┴└─┴ ┴└─┘

// styles for form elements

// <div class="form-control">
//  <input ... />
//  <label class="form-label">...</label>
// </div>
.form-control {
  position: relative;

  display: flex;
  align-items: center;

  // for all but radio and checkbox controls
  input:not([type='checkbox']):not([type='radio']) {
    position: relative;

    padding: 0.5rem;

    color: var(--color-text);
    font-size: 1rem;

    background-color: var(--color-bg);
    border: none;
    border-bottom: var(--line-width) solid var(--color-primary);
  }

  // for controls with embedded icon
  // <div class="form-control -with-icon">
  //  <input ... />
  //  <svg ...></svg>
  // </div>
  &.-with-icon {
    input:not([type='checkbox']):not([type='radio']) {
      padding-left: 2rem;
    }

    svg {
      position: absolute;
      top: 6px;
      left: 0;
    }
  }

  // small utility class to have input control stretch horizontally
  // as much as possible
  &.-is-expanded {
    flex-grow: 1;
    flex-shrink: 1;

    input:not([type='checkbox']):not([type='radio']) {
      width: 100%;
      max-width: 100%;
    }
  }
}

// radio & checkbox controls
.form-control [type='checkbox'],
.form-control [type='radio'] {
  @include visually-hidden;

  // making room for custom styled checkbox indicators
  + .form-label {
    display: inline-block;
    padding-left: 2rem;

    cursor: pointer;
  }
}

// style for the base control to replace native
.form-control [type='checkbox'] + .form-label::before,
.form-control [type='radio'] + .form-label::before,
.form-control [type='radio'] + .form-label::after {
  position: absolute;
  top: 4px;
  left: 0;

  width: 20px;
  height: 20px;

  background-color: var(--color-primary);

  content: '';
}

// radio controls are round, m'kay
.form-control [type='radio'] + .form-label::before {
  background-color: var(--color-bg);
  border: var(--line-width) solid var(--color-primary);
  border-radius: 50%;
}

// render checkmark for checkbox, invisible initially
.form-control [type='checkbox'] + .form-label::after {
  position: absolute;
  top: 10px;
  left: 3px;

  width: 14px;
  height: 6px;

  border-bottom: var(--line-width) solid var(--color-bg);
  border-left: var(--line-width) solid var(--color-bg);
  transform: rotate(-45deg);
  opacity: 0;

  transition: opacity 0.1s ease-in-out;

  content: '';
}

// render selected radio mark, invisible initially
.form-control [type='radio'] + .form-label::after {
  background-color: var(--color-primary);
  border-radius: 50%;
  transform: scale(0.4);
  opacity: 0;

  content: '';
}

// reveal check mark or selected radio when selected
.form-control [type='checkbox']:checked + .form-label::after,
.form-control [type='radio']:checked + .form-label::after {
  opacity: 1;
}

// focus styles
.form-control [type='checkbox']:focus + .form-label::before,
.form-control [type='radio']:focus + .form-label::before,
.form-control input:focus:not([type='checkbox']):not([type='radio']) {
  outline: var(--color-secondary) dotted var(--line-width);
  outline-offset: var(--line-width);
}

// disabled styles
.form-control [type='checkbox']:disabled,
.form-control [type='radio']:disabled {
  + .form-label {
    color: var(--color-bg-light);

    cursor: not-allowed;
  }
}

.form-control [type='checkbox']:disabled + .form-label::before {
  background-color: var(--color-bg-light);
}

.form-control [type='radio']:disabled + .form-label::before {
  border-color: var(--color-bg-light);
}

.form-control [type='radio']:disabled + .form-label::after {
  background-color: var(--color-bg-light);
}

// stylelint-disable-next-line
.form-control input:not([type='checkbox']):not([type='radio']) + .form-label {
  margin-left: 0.5rem;
}

.form-control input:disabled:not([type='checkbox']):not([type='radio']) {
  color: var(--color-bg-light);

  border-color: var(--color-bg-light);

  // stylelint-disable-next-line
  + .form-label {
    color: var(--color-bg-light);
  }
}

.form-control input:invalid:not([type='checkbox']):not([type='radio']) {
  color: var(--color-red);

  border-color: var(--color-red);
}

// for grouping many .form-control elements
.form-controls {
  display: flex;
  justify-content: space-between;
  padding: 0.5rem 1rem;

  border: none;

  .form-control {
    margin-right: 0.5rem;
  }

  // .-stack is for vertically stacking controls
  &.-stack {
    flex-flow: column nowrap;

    .form-control:not(:last-child) {
      margin-bottom: 0.5rem;
    }
  }
}

// <details class="details">
//  <summary class="summary"></summary>
//  ..
// </details>
.details {
  > .summary {
    position: relative;

    padding-right: 1.5em;
    padding-bottom: 0.3em;

    overflow: hidden;

    cursor: pointer;

    // hide details marker on Chrome
    // stylelint-disable declaration-no-important
    &::-webkit-details-marker {
      display: none !important;
    }

    //hide details marker on Firefox
    &:first-of-type {
      list-style-type: none !important;
    }
    // stylelint-enable declaration-no-important

    // super hacky way to remove
    // marker on details element
    //
    // text-indent: -1em;
    // Firefox - hide marker
    // &::-webkit-details-marker,
    // &::marker {
    //   display: none;
    //   color: var(--color-coal);
    // }
    // also could work with:
    // display: block;
    // nothing seems to work on Chrome
  }

  .details-icon-expand {
    position: absolute;
    top: 0.2em;
    right: 0;

    color: var(--color-primary);

    transform-origin: 50% 49%;

    transition: transform 0.2s;
  }

  &[open] .details-icon-expand {
    transform: rotate(0.5turn);
  }
}
